\section[Weryfikacja]{Część weryfikacyjna} % 30-40% - opis wyników, analiza, weryfikacja i porównanie do danych literaturowych
    Niniejsza analiza przeprowadzona została na ``finalnej'' w chwili pisania
    niniejszej pracy wersji programu.  W repozytorium Git na Githubie jest to
    commit ``placeholder'' \todo[inline]{uzupełnić commita} identyfikowany
    również jako wersja 1.0.

    \subsection{Przypadki testowe}

    Kod przetestowano w dwojaki sposób. Pierwszym z nich są testy jednostkowe.
    Automatyczne testy jednostkowe uruchamiane po każdej wymiernej zmianie kodu
    pozwalają kontrolować działanie programu znacznie ułatwiają zapobieganie
    błędom.

    Poszczególne algorytmy podlegały testom przy użyciu ogólnodostępnego
    pakietu \code{pytest} \todo[inline]{pytest reference.} i w większości były
    uruchamiane na platformie TravisCI.

    \subsubsection{Testy algorytmiczne}
    Testy algorytmiczne polegały na przeprowadzeniu fragmentu symulacji - w
    przypadku testów algorytmów było to na przykład wygenerowanie pojedynczej
    cząstki o jednostkowej prędkości oraz zdepozytowanie jej gęstości prądu na
    siatkę, co pozwala porównać otrzymany wynik z przewidywanym analitycznie
    dla danego rozmiaru siatki i położenia cząstki.
    \todo[inline]{sprawdzić listę testów}
    \begin{enumerate}
        \itemi Gather
            \begin{enumerate}
                \item Depozycja prądu z pojedynczej cząstki na niewielką siatkę
                \item Depozycja prądu z dwóch pojedynczych cząstek na niewielką
                    siatkę i porównanie z sumą prądów dla obu pojedynczyczh
                    cząstek
                \item Depozycja prądu z dużej ilości równomiernie rozłożonych
                    cząstek
            \end{enumerate}

        \itemi Solve
            \begin{enumerate}
                \item Symulacja fali sinusoidalnej, obwiedni impulsu i złożenia
                    tych dwóch propagujących się w próżni
            \end{enumerate}

        \itemi Scatter
            \begin{enumerate}
                \item \ldots \todo[inline]{write these}
            \end{enumerate}

        \itemi Push
            \begin{enumerate}
                \itemii Ruch w jednorodnym polu elektrycznym wzdłuż osi układu
                \itemii Ruch w jednorodnym polu magnetycznym z polem
                    magnetycznym
            \end{enumerate}
    \end{enumerate}

    \subsection{Testy symulacyjne - przypadki elektrostatyczne}
    Testy symulacyjne polegały na uruchomieniu niewielkiej symulacji testowej z
    różnymi warunkami brzegowymi i ilościowym, automatycznym zweryfikowaniu
    dynamiki zjawisk w niej zachodzących.

    Zastosowano kod do symulacji kilku znanych problemów w fizyce plazmy:
    \subsubsection{oscylacje zimnej plazmy}
    Jest to efektywnie elektrostatyczna fala stojąca. Symulacja zaczyna z ujemnymi cząstkami
o zerowej prędkości początkowej, rozłożonymi w okresowym pudełku symulacyjnym
równomiernie z nałożonym na nie sinusoidalnym zaburzeniem:

\begin{align}
x = x_0 + x_1
x_0 = L * n / N
x_1 = A  \sin(k x_0)=A \sin(2 \pi n x_0 / L)
\end{align}

Określenie ``zimna plazma'' bierze się z nietermalnego, a deltowego
rozkładu prędkości cząstek - jest to faktycznie strumień cząstek o stałej
(w tym szczególnym przypadku zerowej) prędkości).

Gęstość ładunku jest wyzerowana w pierwszym kroku algorytmu rozwiązywania pola elektrycznego
poprzez wyzerowanie zerowej składowej fourierowskiej gęstości ładunku, cojest jednoznaczne 
z przyjęciem nieskończenie masywnych i nieruchomych jonów dodatnich dokładnie neutralizujących gęstość
ładunku elektronów.

Sytuacja ta
pozwala na obserwację oscylacji cząstek wokół ich stabilnych położeń
równowagi. W przestrzeni fazowej $x, V_x$ cząstki zataczają efektywnie
elipsy, co pozwala wnioskować że ruch ten jest z dobrym przybliżeniem harmoniczny.
Oczywiście, nie jest do do końca oscylacja harmoniczna z powodu odchyleń pola interpolowanego
z Eulerowskiej siatki od generowanego faktycznym potencjałem $ \sim x^2 $.

Jest to, oczywiście, spełnione jedynie dla niewielkich odchyleń; dla $A \to
dx$ \todo[inline]{dx} obserwuje się nieliniowy reżim oscylacji, 

Symulacja ta jest wykorzystywana do weryfikacji podstawowych warunków, jakie powinna spełniać
symulacja elektrostatyczna - na przykład długoskalowe zachowanie energii, liczby cząstek (w układzie okresowym cząstki nie powinny
znikać), % TODO inne rzeczy

    \subsubsection{niestabilność dwóch strumieni}
W tym przypadku symulacja również zawiera zimną plazmę, lecz tym razem są to dwa strumienie ujemnych cząstek
o stałych, przeciwnych sobie prędkościach $v_0$ oraz $-v_0$.

    Dla niewielkich prędkości \todo[inline]{sparametryzować} obserwuje się
    liniowy reżim cząstek - oba strumienie pozostają stabilne. Obserwuje się niewielkie oscylacje oraz
grupowanie się cząstek w rejony koherentnej większej gęstości wewnątrz strumienia (opisany przez Birdsalla i Langdona \emph{bunching}).

    Dla dużych prędkości \todo[inline]{sprawdzić} obserwuje się nieliniowe
    zachowanie cząstek w przestrzeni fazowej. Oscylacje prędkości cząstek przybierają rząd wielkości porównywalny
    z początkową różnicą prędkości strumieni.
 Strumienie zaczynają się mieszać ze sobą nawzajem, zaś cały układ się termalizuje. Energia kinetyczna 
 strumieni zamienia się w energię potencjalną pola równowagowego ą % TODO CHECK
oraz termalną energię kinetyczną, co sprawia, że średnia prędkość obu strumieni ulega zmniejszeniu. % TODO CHECK

To oraz szybkość narastania niestabilności jest obiektem automatycznych testów sprawdzających poprawność symulacji.
% TODO TEST

\subsubsection{Propagacja fali}
W tym przypadku symulacja nie zawiera plazmy, a badana jest jedynie propagacja fali elektromagnetycznej w obszarze
symulacji dla różnych charakterystyk czasowych. % TODO KABAT
Testy jednostkowe obejmują zachowanie energii % TODO POYNTING FLUX

\subsubsection{Oddziaływanie strumienia plazmy z gęstą plazmą tła}
% TODO

    \subsection{Symulacja elektromagnetyczna - oddziaływanie z tarczą wodorową}

    Jako warunki początkowe przyjęto plazmę rozbitą na dwie części - \emph{preplazmę} o narastającej funkcji rozkładu
    gęstości oraz plazmę właściwą o stałej gęstości. Funkcja gęstości jest generowana automatycznie poprzez metodę opisaną
    w % TODO BIRDSALL
    i jest normalizowana do danego poziomu maksymalnej gęstości w obszarze plazmy właściwej przy zadanej liczbie makrocząstek.

    Początkowe prędkości cząstek przyjęto jako zerowe.
    \todo[inline]{wylosowano z relatywistycznego rozkładu Maxwella w kierunkach y, z}

    Za moc lasera przyjęto wielkości $10^{21}, 10^{22}, 10^{23} W/m^2$, 
    zaś za jego długość fali 1.064 $\mu$m (jest to laser Nd:YAG). Przeprowadzono badania w polaryzacjach liniowych oraz
    kołowej wiązki laserowej.

    Długość obszaru symulacji to \todo[inline]{wstawić}.

    Prędkość światła $c$, stałą dielektryczną $\varepsilon_0$, ładunek
    elementarny $e$, masy protonu i elektronu $m_p$, $m_e$ przyjęto według
    tablic, jak obrazuje następująca tabela:

    \todo[inline]{zrobić tabelkę na stałe}

    \subsection{Benchmarki - szybkość, zasobożerność} \todo[inline]{fix}
     Do przeprowadzenia testów wydajności kodu użyto
* ipython
* cprofile
* runsnake???
Za wskaźnik efektów optymalizacji przyjętu całkowity czas trwania symulacji oraz ułamek tego czasu spędzony w funkcji
\code{iteration}.

    \subsection{Problemy napotkane w trakcie pisania kodu}
